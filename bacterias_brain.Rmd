---
title: "Lab 1: Molecular Mechanisms for Human Diseases"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
theme_set(theme_minimal())
```

Data: 
```{r import data}
#import A;
novick_a <- read.csv("data/g149novickA.csv", header = FALSE) 
novick_a <- novick_a %>%   
  # separate columns and add titles;
  separate_wider_delim(1, ",", names = c("t", "concentration")) %>%
  # render as number
  mutate_if(is.character, as.numeric) %>%
  # show result
  glimpse()

#import B; 
novick_b <- read.csv("data/g149novickB.csv", header = FALSE) 
novick_b <- novick_b %>%   
  # separate columns and add titles;
  separate_wider_delim(1, ",", names = c("t", "concentration")) %>% 
  # render as number
  mutate_if(is.character, as.numeric) %>%
  # show result
  glimpse()

```

Visualization of Data set A
```{r plot_A}
#plot_title <- glue::glue("")
novick_a %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal ",
    subtitle = "in response to high TMG concentration",
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) + 
  theme_light() +
  geom_smooth()


```
Fitting function on Data set A
```{r fit_function_A}
#define function
growth_a <- function (t, ampl, tau) (ampl*(1- exp(-(t/tau))))
  
#fit function without (0,0)
a_q2 <- nls(novick_a$concentration ~ growth_a(t, ampl, tau), data = novick_a, start = list(ampl = 1.26, tau = 2.62))

coef_a <- coef(a_q2)
#create dataframe for function
df_a_growth <- data.frame(x = t, y = growth_a(t, ampl = coef_a[[1]], tau = coef_a[[2]]))

novick_a %>%
  ggplot() + 
  geom_point(aes(x = t, y = concentration)) + 
  labs(aes(x = t, y = concentration), 
    title = "growth of beta-gal", 
    subtitle = "in response to high TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) + 
  geom_line(aes(x = t, y = concentration, data = df_a_growth), 
    ampl = coef_a[[1]], 
    tau = coef_a[[2]])


```

Analysis: 


Visualization of Data set B
```{r plot_B}
novick_b %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal", 
    subtitle = "in response to lower TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) + 
  theme_light()
```
Fitting function on Data set B
```{r fit_function_B}

# get data for 10<=t<=15
b_q2 <- novick_b %>% 
  filter(t >= 10) %>% 
  filter(t <= 15)
# fit straight line for 10<= t <= 15

b_q2 <- lm(b_q2$concentration ~ b_q2$t)
coef_b <- coef(b_q2)
# plot

novick_b %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal", 
    subtitle = "in response to lower TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) + 
  geom_abline(
    intercept = coef_b[[1]], 
    slope = coef_b[[2]])

```

Analysis: 



