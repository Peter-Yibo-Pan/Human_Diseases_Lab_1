---
title: "Lab 1: Molecular Mechanisms for Human Diseases"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
theme_set(theme_minimal())
```

Data: 
```{r import data}
#import A;
novick_a <- read.csv("data/g149novickA.csv", header = FALSE) 
novick_a <- novick_a %>%   
  # separate columns and add titles;
  separate_wider_delim(1, ",", names = c("t", "concentration")) %>%
  # render as number
  mutate_if(is.character, as.numeric) %>%
  # show result
  glimpse()

#import B; 
novick_b <- read.csv("data/g149novickB.csv", header = FALSE) 
novick_b <- novick_b %>%   
  # separate columns and add titles;
  separate_wider_delim(1, ",", names = c("t", "concentration")) %>% 
  # render as number
  mutate_if(is.character, as.numeric) %>%
  # show result
  glimpse()

```

Visualization of Data set A
```{r a_Q1}
#plot_title <- glue::glue("")
novick_a %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal ",
    subtitle = "in response to high TMG concentration",
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) 

```
Fitting function on Data set A
```{r a_q2&3}
#define function
growth_a <- function (t, ampl, tau) (ampl*(1- exp(-(t/tau))))
  
#fit function without (0,0)
a_q2 <- nls(novick_a$concentration ~ growth_a(t, ampl, tau), data = novick_a, start = list(ampl = 1.26, tau = 2.62))

coef_a <- coef(a_q2)
#create dataframe for function
growth_a <- tibble(t = 0:7, 
                   concentration = growth_a(t, 
                                            ampl = coef_a[[1]], 
                                            tau = coef_a[[2]]))

novick_a %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs( 
    title = "growth of beta-gal", 
    subtitle = "in response to high TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  )  +
  geom_line(aes(x = t, y = concentration), data = growth_a)


```

Analysis: 


Visualization of Data set B
```{r b_q1}
novick_b %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal", 
    subtitle = "in response to lower TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) 
```
Fitting function on Data set B
```{r b_q2}
# get data for 10<=t<=15
b_q2 <- novick_b %>% 
  filter(t >= 10) %>% 
  filter(t <= 15)
# fit straight line for 10<= t <= 15

b_q2 <- lm(b_q2$concentration ~ b_q2$t)
coef_b2 <- coef(b_q2)
  # plot
novick_b %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs(
    title = "growth of beta-gal", 
    subtitle = "in response to lower TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  ) + 
  geom_abline(
    intercept = coef_b2[[1]], 
    slope = coef_b2[[2]])


```


```{r b_q3&4}
# fit function from a
# define function
growth_b <- function (t, ampl, tau) (ampl*(1- exp(-(t/tau))))

# fit function
b_q3 <- nls(novick_b$concentration ~ growth_b(t, ampl, tau), data = novick_b, start = list(ampl = 5, tau = 10))

coef_b3 <- coef(b_q3)
# create dataframe for function
growth_b <- tibble(t = 0:20, 
                   concentration = growth_b(t, 
                                            ampl = coef_b3[[1]], 
                                            tau = coef_b3[[2]]))
# plot
novick_a %>%
  ggplot(aes(x = t, y = concentration)) + 
  geom_point() + 
  labs( 
    title = "growth of beta-gal", 
    subtitle = "in response to high TMG concentration", 
    x = "time (hours)", 
    y = "fraction of maximum beta-gal"
  )  +
  geom_line(aes(x = t, y = concentration), data = growth_a)

```

Analysis: 



